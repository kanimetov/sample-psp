## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (MVP)

- **PSP Service** (Spring Boot, stateless, 6‚Äì10 –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤)
  - **IncomingController** - Beneficiary —Ñ–∞—Å–∞–¥ (/in/qr/{version}/tx/*)
  - **SignatureService** - JWS v2 –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–µ–π
  - **IncomingService** - –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Ö–æ–¥—è—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
  - **OperatorClient** - –ö–ª–∏–µ–Ω—Ç –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)
  - **Oracle** - –û—Å–Ω–æ–≤–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (transactions, check_requests, extra_data)
  - **Redis** - –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)
  - **RabbitMQ** - –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

- ‚úÖ **–í—Ö–æ–¥—è—â–∏–µ API** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –æ—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
- ‚úÖ **–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–µ–π** - JWS v2 —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è DTO** - –∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –¥–µ—Ç–∞–ª—å–Ω–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π GlobalExceptionHandler
- ‚úÖ **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** - –ø–æ–ª–Ω–∞—è —Å—Ö–µ–º–∞ —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏

### –ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

- üîÑ **–í–Ω–µ—à–Ω–∏–µ API** - —Ñ–∞—Å–∞–¥ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤ (/api/qr/tx/*)
- üîÑ **OperatorClient** - –∏—Å—Ö–æ–¥—è—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –æ–ø–µ—Ä–∞—Ç–æ—Ä—É
- üîÑ **Redis** - –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å
- üîÑ **RabbitMQ** - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏ DLQ
- üîÑ **Outbox pattern** - –Ω–∞–¥–µ–∂–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ —Å–æ–±—ã—Ç–∏–π

### –ì–æ—Ä—è—á–∏–π –ø—É—Ç—å (—Ç–µ–∫—É—â–∏–π)

**–í—Ö–æ–¥—è—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã**: `/in/qr/{version}/tx/*` ‚Üí –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–∏ ‚Üí –≤–∞–ª–∏–¥–∞—Ü–∏—è DTO ‚Üí –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ ‚Üí –æ—Ç–≤–µ—Ç

**–ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–π**: API ‚Üí –≤–∞–ª–∏–¥–∞—Ü–∏—è ‚Üí –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å ‚Üí JWS/JWE ‚Üí –æ–ø–µ—Ä–∞—Ç–æ—Ä ‚Üí –º–∞–ø–ø–∏–Ω–≥ ‚Üí –æ—Ç–≤–µ—Ç

### Fallback —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏

- UPDATE —á–µ—Ä–µ–∑ MQ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ñ–∏–Ω–∞–ª–∞
- GET —Å—Ç–∞—Ç—É—Å –ø—Ä–∏ timeout
- Retry –º–µ—Ö–∞–Ω–∏–∑–º—ã —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π


